<!-- 
Character Creation Form Template for D&D 5th Edition 2024
This is used by the CharacterCreationComponent
-->

<div>{{ json formData }}</div>

<div class="character-creation-container">
  <div class="form-steps">
    <div class="step {{#if (eq currentPage 'class-page')}}active{{/if}} {{#if (eq currentPage 'origin-page')}}completed{{/if}} {{#if (eq currentPage 'abilities-page')}}completed{{/if}} {{#if (eq currentPage 'details-page')}}completed{{/if}}">1. Class</div>
    <div class="step {{#if (eq currentPage 'origin-page')}}active{{/if}} {{#if (eq currentPage 'abilities-page')}}completed{{/if}} {{#if (eq currentPage 'details-page')}}completed{{/if}}">2. Origin</div>
    <div class="step {{#if (eq currentPage 'abilities-page')}}active{{/if}} {{#if (eq currentPage 'details-page')}}completed{{/if}}">3. Abilities</div>
    <div class="step {{#if (eq currentPage 'details-page')}}active{{/if}}">4. Details</div>
  </div>
  
  <!-- Form page: Class selection -->
  <div id="class-page" class="form-page {{#if (eq currentPage 'class-page')}}active{{/if}}">
    <h2>Choose a Class</h2>
    <p>Your character's class represents their primary adventuring profession and specialization.</p>

    <!-- Debug class data -->
    <div style="background-color: #f7f7f7; padding: 10px; margin: 10px 0; font-family: monospace; font-size: 12px;">
      <p>Class name: {{#if formData.class}}{{formData.class.name}}{{else}}none selected{{/if}}</p>
      <p>Class document: {{#if classDocument}}Found{{else}}Not found{{/if}}</p>
    </div>
    <div class="form-group">
      <label for="character-class">Class:</label>
      <select id="character-class" name="class.name" required>
        <option value="">-- Select Class --</option>
        {{#each (getAllClasses)}}
          <option value="{{this.id}}" {{#if (eq formData.class.name this.name)}}selected{{/if}}>{{this.name}}</option>
        {{/each}}
      </select>
    </div>

    {{#if classDocument}}
    <div class="class-details">
      <h3>{{formData.class.name}}</h3>
      <p class="class-description">{{classDocument.description}}</p>
      
      <div class="class-traits">
        <h4>Class Features</h4>
        <ul>
          <li><strong>Hit Die:</strong> {{classDocument.hitDie}}</li>
          <li><strong>Primary Ability:</strong> {{join classDocument.primaryAbility ", "}}</li>
          <li><strong>Saving Throws:</strong> {{join classDocument.savingThrows ", "}}</li>
          <li><strong>Armor Proficiencies:</strong> {{join classDocument.proficiencies.armor ", "}}</li>
          <li><strong>Weapon Proficiencies:</strong> {{join classDocument.proficiencies.weapons ", "}}</li>
          <li><strong>Tool Proficiencies:</strong> {{join classDocument.proficiencies.tools ", "}}</li>
        </ul>
      </div>
      
      {{#each classDocument.proficiencies.skills}}
        <div class="skill-section">
          <h4>Skill Proficiencies</h4>
          <p>Choose {{this.count}} from the following skills:</p>
          <div class="skill-options">
            {{#each this.options}}
              <div class="skill-checkbox">
                <input type="checkbox" id="skill-{{this}}" name="class.selectedSkills" 
                       value="{{this}}" 
                       {{#if (includes ../../../formData.class.selectedSkills this)}}checked{{/if}}>
                <label for="skill-{{this}}">{{capitalize this}}</label>
              </div>
            {{/each}}
          </div>
        </div>
      {{/each}}
      
      {{#if classDocument.equipment}}
        <div class="equipment-choice">
          <h4>Starting Equipment</h4>
          <p>Choose one of the following equipment options:</p>
          
          <div class="equipment-options">
            <div class="equipment-option">
              <input type="radio" id="equipment-A" name="class.selectedEquipment" 
                     value="A" {{#if (eq formData.class.selectedEquipment "A")}}checked{{/if}}>
              <label for="equipment-A">
                <strong>Option A:</strong>
                <ul>
                  {{#each classDocument.equipment.choices}}
                    <li>{{this.item}} {{#if this.quantity}}({{this.quantity}}){{/if}}</li>
                  {{/each}}
                </ul>
              </label>
            </div>
            
            <div class="equipment-option">
              <input type="radio" id="equipment-B" name="class.selectedEquipment" 
                     value="B" {{#if (eq formData.class.selectedEquipment "B")}}checked{{/if}}>
              <label for="equipment-B">
                <strong>Option B:</strong>
                <ul>
                  {{#each classDocument.equipment.choices}}
                    <li>{{this.item}} {{#if this.quantity}}({{this.quantity}}){{/if}}</li>
                  {{/each}}
                </ul>
              </label>
            </div>
          </div>
        </div>
      {{/if}}
      
      {{#if classDocument.features}}
        <div class="class-features">
          <h4>1st Level Features</h4>
          {{#each classDocument.features}}
            {{#each this}}
              {{#if (eq this.level 1)}}
                <div class="feature">
                  <h5>{{this.name}}</h5>
                  <p>{{this.description}}</p>
                </div>
              {{/if}}
            {{/each}}
          {{/each}}
        </div>
      {{/if}}
    </div>
    {{/if}}
    
    <div class="form-nav">
      <button type="button" class="next-button">Next: Origin</button>
    </div>
  </div>
  
  <!-- Form page: Origin selection -->
  <div id="origin-page" class="form-page {{#if (eq currentPage 'origin-page')}}active{{/if}}">
    <h2>Choose Your Origin</h2>
    <p>Your origin defines your character's species and background.</p>
    
    <!-- Debug origin data -->
    <div style="background-color: #f7f7f7; padding: 10px; margin: 10px 0; font-family: monospace; font-size: 12px;">
      <p>Species name: {{#if formData.origin}}{{formData.origin.species}}{{else}}none selected{{/if}}</p>
      <p>Species document: {{#if speciesDocument}}Found{{else}}Not found{{/if}}</p>
      <p>Background name: {{#if formData.origin}}{{formData.origin.background}}{{else}}none selected{{/if}}</p>
      <p>Background document: {{#if backgroundDocument}}Found{{else}}Not found{{/if}}</p>
    </div>
    
    <div class="form-group">
      <label for="character-species">Species:</label>
      <select id="character-species" name="origin.species" required>
        <option value="">-- Select Species --</option>
        <option value="human" {{#if (eq formData.origin.species "human")}}selected{{/if}}>Human</option>
        <option value="elf" {{#if (eq formData.origin.species "elf")}}selected{{/if}}>Elf</option>
        <option value="dwarf" {{#if (eq formData.origin.species "dwarf")}}selected{{/if}}>Dwarf</option>
        <option value="halfling" {{#if (eq formData.origin.species "halfling")}}selected{{/if}}>Halfling</option>
        <option value="dragonborn" {{#if (eq formData.origin.species "dragonborn")}}selected{{/if}}>Dragonborn</option>
        <option value="gnome" {{#if (eq formData.origin.species "gnome")}}selected{{/if}}>Gnome</option>
        <option value="half-elf" {{#if (eq formData.origin.species "half-elf")}}selected{{/if}}>Half-Elf</option>
        <option value="half-orc" {{#if (eq formData.origin.species "half-orc")}}selected{{/if}}>Half-Orc</option>
        <option value="tiefling" {{#if (eq formData.origin.species "tiefling")}}selected{{/if}}>Tiefling</option>
      </select>
    </div>
    
    {{#if speciesDocument}}
    <div class="species-details">
      <h3>{{speciesDocument.name}}</h3>
      <p>{{speciesDocument.description}}</p>
      
      <div class="species-traits">
        <h4>Species Traits</h4>
        <ul>
          <li><strong>Size:</strong> {{speciesDocument.size}}</li>
          <li><strong>Speed:</strong> {{speciesDocument.speed}} feet</li>
          {{#each speciesDocument.traits}}
            <li><strong>{{this.name}}:</strong> {{this.description}}</li>
          {{/each}}
        </ul>
      </div>
    </div>
    {{/if}}
    
    <div class="form-group">
      <label for="character-background">Background:</label>
      <select id="character-background" name="origin.background" required>
        <option value="">-- Select Background --</option>
        <option value="acolyte" {{#if (eq formData.origin.background "acolyte")}}selected{{/if}}>Acolyte</option>
        <option value="charlatan" {{#if (eq formData.origin.background "charlatan")}}selected{{/if}}>Charlatan</option>
        <option value="criminal" {{#if (eq formData.origin.background "criminal")}}selected{{/if}}>Criminal</option>
        <option value="entertainer" {{#if (eq formData.origin.background "entertainer")}}selected{{/if}}>Entertainer</option>
        <option value="folk-hero" {{#if (eq formData.origin.background "folk-hero")}}selected{{/if}}>Folk Hero</option>
        <option value="guild-artisan" {{#if (eq formData.origin.background "guild-artisan")}}selected{{/if}}>Guild Artisan</option>
        <option value="hermit" {{#if (eq formData.origin.background "hermit")}}selected{{/if}}>Hermit</option>
        <option value="noble" {{#if (eq formData.origin.background "noble")}}selected{{/if}}>Noble</option>
        <option value="outlander" {{#if (eq formData.origin.background "outlander")}}selected{{/if}}>Outlander</option>
        <option value="sage" {{#if (eq formData.origin.background "sage")}}selected{{/if}}>Sage</option>
        <option value="sailor" {{#if (eq formData.origin.background "sailor")}}selected{{/if}}>Sailor</option>
        <option value="soldier" {{#if (eq formData.origin.background "soldier")}}selected{{/if}}>Soldier</option>
        <option value="urchin" {{#if (eq formData.origin.background "urchin")}}selected{{/if}}>Urchin</option>
      </select>
    </div>
    
    {{#if backgroundDocument}}
    <div class="background-details">
      <h3>{{backgroundDocument.name}}</h3>
      <p>{{backgroundDocument.description}}</p>
      
      <div class="background-features">
        <h4>Background Features</h4>
        <ul>
          <li><strong>Skill Proficiencies:</strong> {{join backgroundDocument.skillProficiencies ", "}}</li>
          {{#if backgroundDocument.toolProficiencies}}
            <li><strong>Tool Proficiencies:</strong> {{join backgroundDocument.toolProficiencies ", "}}</li>
          {{/if}}
          <li><strong>Ability Boosts:</strong> {{join backgroundDocument.abilities ", "}}</li>
        </ul>
      </div>
      
      <div class="ability-boost-section">
        <h4>Ability Score Improvements</h4>
        <p>Choose how to distribute your ability score improvements:</p>
        
        <div class="ability-boost-options">
          <div class="boost-option">
            <h5>Option 1: Three +1 Boosts</h5>
            <div class="ability-checkboxes">
              {{#each backgroundDocument.abilities}}
                <div class="ability-checkbox">
                  <input type="checkbox" id="boost-{{this}}" name="origin.selectedAbilityBoosts" 
                         value="{{this}}" 
                         {{#if (includes ../formData.origin.selectedAbilityBoosts this)}}checked{{/if}}>
                  <label for="boost-{{this}}">{{capitalize this}}</label>
                </div>
              {{/each}}
            </div>
          </div>
          
          <div class="boost-option">
            <h5>Option 2: One +2 and One +1 Boost</h5>
            <div class="plus-two-select">
              <label for="plus-two-ability">+2 to:</label>
              <select id="plus-two-ability" name="origin.bonusPlusTwo">
                <option value="">-- Select Ability --</option>
                {{#each backgroundDocument.abilities}}
                  <option value="{{this}}" {{#if (eq ../../formData.origin.bonusPlusTwo this)}}selected{{/if}}>{{capitalize this}}</option>
                {{/each}}
              </select>
            </div>
            
            <div class="plus-one-select">
              <label for="plus-one-ability">+1 to:</label>
              <select id="plus-one-ability" name="origin.bonusPlusOne">
                <option value="">-- Select Ability --</option>
                {{#each backgroundDocument.abilities}}
                  <option value="{{this}}" {{#if (eq ../../formData.origin.bonusPlusOne this)}}selected{{/if}}>{{capitalize this}}</option>
                {{/each}}
              </select>
            </div>
          </div>
        </div>
      </div>
      
      <div class="language-section">
        <h4>Languages</h4>
        <p>You can speak, read, and write Common and two additional languages of your choice.</p>
        
        <div class="language-options">
          <select name="origin.selectedLanguages" multiple>
            <option value="dwarvish" {{#if (includes formData.origin.selectedLanguages "dwarvish")}}selected{{/if}}>Dwarvish</option>
            <option value="elvish" {{#if (includes formData.origin.selectedLanguages "elvish")}}selected{{/if}}>Elvish</option>
            <option value="giant" {{#if (includes formData.origin.selectedLanguages "giant")}}selected{{/if}}>Giant</option>
            <option value="gnomish" {{#if (includes formData.origin.selectedLanguages "gnomish")}}selected{{/if}}>Gnomish</option>
            <option value="goblin" {{#if (includes formData.origin.selectedLanguages "goblin")}}selected{{/if}}>Goblin</option>
            <option value="halfling" {{#if (includes formData.origin.selectedLanguages "halfling")}}selected{{/if}}>Halfling</option>
            <option value="orc" {{#if (includes formData.origin.selectedLanguages "orc")}}selected{{/if}}>Orc</option>
            <option value="abyssal" {{#if (includes formData.origin.selectedLanguages "abyssal")}}selected{{/if}}>Abyssal</option>
            <option value="celestial" {{#if (includes formData.origin.selectedLanguages "celestial")}}selected{{/if}}>Celestial</option>
            <option value="draconic" {{#if (includes formData.origin.selectedLanguages "draconic")}}selected{{/if}}>Draconic</option>
            <option value="deep-speech" {{#if (includes formData.origin.selectedLanguages "deep-speech")}}selected{{/if}}>Deep Speech</option>
            <option value="infernal" {{#if (includes formData.origin.selectedLanguages "infernal")}}selected{{/if}}>Infernal</option>
            <option value="primordial" {{#if (includes formData.origin.selectedLanguages "primordial")}}selected{{/if}}>Primordial</option>
            <option value="sylvan" {{#if (includes formData.origin.selectedLanguages "sylvan")}}selected{{/if}}>Sylvan</option>
            <option value="undercommon" {{#if (includes formData.origin.selectedLanguages "undercommon")}}selected{{/if}}>Undercommon</option>
          </select>
          <p class="help-text">Hold Ctrl/Cmd to select multiple languages (max 2)</p>
        </div>
      </div>
    </div>
    {{/if}}
    
    <div class="form-nav">
      <button type="button" class="back-button">Back: Class</button>
      <button type="button" class="next-button">Next: Abilities</button>
    </div>
  </div>
  
  <!-- Form page: Ability Scores -->
  <div id="abilities-page" class="form-page {{#if (eq currentPage 'abilities-page')}}active{{/if}}">
    <h2>Determine Ability Scores</h2>
    <p>Choose a method to determine your character's ability scores.</p>
    
    <div class="ability-method-selection">
      <div class="method-option">
        <input type="radio" id="method-standard" name="abilities.method" value="standard" 
               {{#if (eq formData.abilities.method "standard")}}checked{{/if}}>
        <label for="method-standard">Standard Array</label>
      </div>
      
      <div class="method-option">
        <input type="radio" id="method-pointbuy" name="abilities.method" value="pointbuy" 
               {{#if (eq formData.abilities.method "pointbuy")}}checked{{/if}}>
        <label for="method-pointbuy">Point Buy</label>
      </div>
      
      <div class="method-option">
        <input type="radio" id="method-roll" name="abilities.method" value="roll" 
               {{#if (eq formData.abilities.method "roll")}}checked{{/if}}>
        <label for="method-roll">Roll for Scores</label>
      </div>
    </div>
    
    <!-- Standard Array Method -->
    <div class="ability-method standard-array-method {{#if (eq formData.abilities.method "standard")}}active{{/if}}">
      <h3>Standard Array</h3>
      <p>Assign the following scores to your abilities: 15, 14, 13, 12, 10, 8</p>
      
      <div class="used-values">
        {{#each formData.abilities.standard}}
          {{#if this}}
            <span class="used-value">{{this}}</span>
          {{/if}}
        {{/each}}
      </div>
      
      <div class="ability-scores">
        {{#each (array "strength" "dexterity" "constitution" "intelligence" "wisdom" "charisma")}}
          <div class="ability-box">
            <label for="standard-{{this}}">{{capitalize this}}</label>
            <select id="standard-{{this}}" name="abilities.standard.{{this}}">
              <option value="">--</option>
              <option value="15" {{#if (eq (lookup ../formData.abilities.standard this) "15")}}selected{{/if}}>15</option>
              <option value="14" {{#if (eq (lookup ../formData.abilities.standard this) "14")}}selected{{/if}}>14</option>
              <option value="13" {{#if (eq (lookup ../formData.abilities.standard this) "13")}}selected{{/if}}>13</option>
              <option value="12" {{#if (eq (lookup ../formData.abilities.standard this) "12")}}selected{{/if}}>12</option>
              <option value="10" {{#if (eq (lookup ../formData.abilities.standard this) "10")}}selected{{/if}}>10</option>
              <option value="8" {{#if (eq (lookup ../formData.abilities.standard this) "8")}}selected{{/if}}>8</option>
            </select>
            <div class="ability-modifier">
              Modifier: {{#with (lookup ../formData.abilities.standard this)}}
                {{abilityMod this}}
              {{else}}
                +0
              {{/with}}
            </div>
          </div>
        {{/each}}
      </div>
    </div>
    
    <!-- Point Buy Method -->
    <div class="ability-method point-buy-method {{#if (eq formData.abilities.method "pointbuy")}}active{{/if}}">
      <h3>Point Buy</h3>
      <p>You have 27 points to spend on your ability scores.</p>
      <p>The costs are: 9 for 15, 7 for 14, 5 for 13, 3 for 12, 2 for 11, 1 for 10, 0 for 9 and 8.</p>
      
      <div id="points-remaining">{{formData.abilities.pointsRemaining}}</div>
      
      <div class="ability-scores">
        {{#each (array "strength" "dexterity" "constitution" "intelligence" "wisdom" "charisma")}}
          <div class="ability-box">
            <label>{{capitalize this}}</label>
            <div class="point-buy-controls">
              <button type="button" class="btn-minus" data-ability="{{this}}">-</button>
              <input type="number" name="abilities.pointbuy.{{this}}" min="8" max="15" value="{{default (lookup ../formData.abilities.pointbuy this) 8}}" readonly>
              <button type="button" class="btn-plus" data-ability="{{this}}">+</button>
            </div>
            <div class="ability-modifier">
              Modifier: {{#with (lookup ../formData.abilities.pointbuy this)}}
                {{abilityMod this}}
              {{else}}
                -1
              {{/with}}
            </div>
          </div>
        {{/each}}
      </div>
    </div>
    
    <!-- Roll Method -->
    <div class="ability-method roll-method {{#if (eq formData.abilities.method "roll")}}active{{/if}}">
      <h3>Roll for Scores</h3>
      <p>Roll 4d6, drop the lowest die, and assign the total to your abilities.</p>
      
      <button type="button" id="roll-abilities-btn">Roll Abilities</button>
      
      <div id="roll-history">
        {{#if formData.abilities.roll}}
          {{#each (array "strength" "dexterity" "constitution" "intelligence" "wisdom" "charisma")}}
            <div>{{capitalize this}}: {{lookup ../formData.abilities.roll this}}</div>
          {{/each}}
        {{/if}}
      </div>
      
      <div class="ability-scores">
        {{#each (array "strength" "dexterity" "constitution" "intelligence" "wisdom" "charisma")}}
          <div class="ability-box">
            <label>{{capitalize this}}</label>
            <input type="number" name="abilities.roll.{{this}}" value="{{default (lookup ../formData.abilities.roll this) 10}}" readonly>
            <div class="ability-modifier">
              Modifier: {{#with (lookup ../formData.abilities.roll this)}}
                {{abilityMod this}}
              {{else}}
                +0
              {{/with}}
            </div>
          </div>
        {{/each}}
      </div>
    </div>
    
    <div class="form-nav">
      <button type="button" class="back-button">Back: Origin</button>
      <button type="button" class="next-button">Next: Details</button>
    </div>
  </div>
  
  <!-- Form page: Character Details -->
  <div id="details-page" class="form-page {{#if (eq currentPage 'details-page')}}active{{/if}}">
    <h2>Character Details</h2>
    <p>Finalize the details of your character.</p>
    
    
    <div class="alignment-section">
      <h3>Alignment</h3>
      <p>Choose an alignment that describes your character's moral and ethical outlook.</p>
      
      <div class="alignment-grid">
        <div class="alignment-cell">
          <input type="radio" id="lawful-good" name="details.alignment" value="lawful-good" 
                 {{#if (eq formData.details.alignment "lawful-good")}}checked{{/if}}>
          <label for="lawful-good">Lawful Good</label>
        </div>
        <div class="alignment-cell">
          <input type="radio" id="neutral-good" name="details.alignment" value="neutral-good" 
                 {{#if (eq formData.details.alignment "neutral-good")}}checked{{/if}}>
          <label for="neutral-good">Neutral Good</label>
        </div>
        <div class="alignment-cell">
          <input type="radio" id="chaotic-good" name="details.alignment" value="chaotic-good" 
                 {{#if (eq formData.details.alignment "chaotic-good")}}checked{{/if}}>
          <label for="chaotic-good">Chaotic Good</label>
        </div>
        <div class="alignment-cell">
          <input type="radio" id="lawful-neutral" name="details.alignment" value="lawful-neutral" 
                 {{#if (eq formData.details.alignment "lawful-neutral")}}checked{{/if}}>
          <label for="lawful-neutral">Lawful Neutral</label>
        </div>
        <div class="alignment-cell">
          <input type="radio" id="true-neutral" name="details.alignment" value="true-neutral" 
                 {{#if (eq formData.details.alignment "true-neutral")}}checked{{/if}}>
          <label for="true-neutral">True Neutral</label>
        </div>
        <div class="alignment-cell">
          <input type="radio" id="chaotic-neutral" name="details.alignment" value="chaotic-neutral" 
                 {{#if (eq formData.details.alignment "chaotic-neutral")}}checked{{/if}}>
          <label for="chaotic-neutral">Chaotic Neutral</label>
        </div>
        <div class="alignment-cell">
          <input type="radio" id="lawful-evil" name="details.alignment" value="lawful-evil" 
                 {{#if (eq formData.details.alignment "lawful-evil")}}checked{{/if}}>
          <label for="lawful-evil">Lawful Evil</label>
        </div>
        <div class="alignment-cell">
          <input type="radio" id="neutral-evil" name="details.alignment" value="neutral-evil" 
                 {{#if (eq formData.details.alignment "neutral-evil")}}checked{{/if}}>
          <label for="neutral-evil">Neutral Evil</label>
        </div>
        <div class="alignment-cell">
          <input type="radio" id="chaotic-evil" name="details.alignment" value="chaotic-evil" 
                 {{#if (eq formData.details.alignment "chaotic-evil")}}checked{{/if}}>
          <label for="chaotic-evil">Chaotic Evil</label>
        </div>
      </div>
    </div>
    
    <div class="physical-traits">
      <h3>Physical Traits</h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="character-age">Age:</label>
          <input type="number" id="character-age" name="details.age" value="{{formData.details.age}}">
        </div>
        
        <div class="form-group">
          <label for="character-height">Height:</label>
          <input type="text" id="character-height" name="details.height" value="{{formData.details.height}}">
        </div>
        
        <div class="form-group">
          <label for="character-weight">Weight:</label>
          <input type="text" id="character-weight" name="details.weight" value="{{formData.details.weight}}">
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="character-eyes">Eyes:</label>
          <input type="text" id="character-eyes" name="details.eyes" value="{{formData.details.eyes}}">
        </div>
        
        <div class="form-group">
          <label for="character-hair">Hair:</label>
          <input type="text" id="character-hair" name="details.hair" value="{{formData.details.hair}}">
        </div>
        
        <div class="form-group">
          <label for="character-skin">Skin:</label>
          <input type="text" id="character-skin" name="details.skin" value="{{formData.details.skin}}">
        </div>
      </div>
    </div>
    
    <div class="personality-section">
      <h3>Personality</h3>
      
      <div class="form-group">
        <label for="character-traits">Personality Traits:</label>
        <textarea id="character-traits" name="details.personalityTraits">{{formData.details.personalityTraits}}</textarea>
      </div>
      
      <div class="form-group">
        <label for="character-ideals">Ideals:</label>
        <textarea id="character-ideals" name="details.ideals">{{formData.details.ideals}}</textarea>
      </div>
      
      <div class="form-group">
        <label for="character-bonds">Bonds:</label>
        <textarea id="character-bonds" name="details.bonds">{{formData.details.bonds}}</textarea>
      </div>
      
      <div class="form-group">
        <label for="character-flaws">Flaws:</label>
        <textarea id="character-flaws" name="details.flaws">{{formData.details.flaws}}</textarea>
      </div>
    </div>
    
    <div class="backstory-section">
      <h3>Backstory</h3>
      
      <div class="form-group">
        <label for="character-backstory">Character Backstory:</label>
        <textarea id="character-backstory" name="details.backstory">{{formData.details.backstory}}</textarea>
      </div>
      
      <div class="form-group">
        <label for="character-allies">Allies & Organizations:</label>
        <textarea id="character-allies" name="details.allies">{{formData.details.allies}}</textarea>
      </div>
      
      <div class="form-group">
        <label for="character-features">Additional Features & Traits:</label>
        <textarea id="character-features" name="details.additionalFeatures">{{formData.details.additionalFeatures}}</textarea>
      </div>
    </div>
    
    <div class="form-nav">
      <button type="button" class="back-button">Back: Abilities</button>
      <button type="submit" class="submit-button">Create Character</button>
    </div>
  </div>
</div> 