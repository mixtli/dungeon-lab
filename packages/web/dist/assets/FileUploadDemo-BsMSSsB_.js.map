{"version":3,"file":"FileUploadDemo-BsMSSsB_.js","sources":["../../src/components/FileUploader.vue","../../src/views/FileUploadDemo.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref, computed } from 'vue';\nimport axios from '../plugins/axios';\n\nconst props = defineProps<{\n  folder?: string;\n  accept?: string;\n  multiple?: boolean;\n  maxSize?: number; // in MB\n}>();\n\nconst emit = defineEmits<{\n  (e: 'upload-success', files: Array<{ url: string; key: string }>): void;\n  (e: 'upload-error', error: Error): void;\n}>();\n\nconst fileInput = ref<HTMLInputElement | null>(null);\nconst selectedFiles = ref<File[]>([]);\nconst uploading = ref(false);\nconst uploadProgress = ref(0);\nconst error = ref<string | null>(null);\n\nconst maxSizeBytes = computed(() => (props.maxSize || 10) * 1024 * 1024);\nconst acceptedFileTypes = computed(() => props.accept || '*');\n\nfunction handleFileSelect(event: Event) {\n  const input = event.target as HTMLInputElement;\n  if (!input.files) return;\n  \n  error.value = null;\n  selectedFiles.value = Array.from(input.files);\n  \n  // Validate file size\n  for (const file of selectedFiles.value) {\n    if (file.size > maxSizeBytes.value) {\n      error.value = `File ${file.name} exceeds the maximum size of ${props.maxSize || 10}MB`;\n      selectedFiles.value = [];\n      if (fileInput.value) fileInput.value.value = '';\n      return;\n    }\n  }\n}\n\nasync function uploadFiles() {\n  if (selectedFiles.value.length === 0) return;\n  \n  uploading.value = true;\n  uploadProgress.value = 0;\n  error.value = null;\n  \n  try {\n    const uploadedFiles = [];\n    \n    for (const file of selectedFiles.value) {\n      const formData = new FormData();\n      formData.append('file', file);\n      if (props.folder) {\n        formData.append('folder', props.folder);\n      }\n      \n      const response = await axios.post('/api/storage/files', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        },\n        onUploadProgress: (progressEvent) => {\n          if (progressEvent.total) {\n            uploadProgress.value = Math.round((progressEvent.loaded * 100) / progressEvent.total);\n          }\n        }\n      });\n      \n      uploadedFiles.push({\n        url: response.data.url,\n        key: response.data.key\n      });\n    }\n    \n    emit('upload-success', uploadedFiles);\n    selectedFiles.value = [];\n    if (fileInput.value) fileInput.value.value = '';\n  } catch (err) {\n    console.error('Error uploading files:', err);\n    error.value = err instanceof Error ? err.message : 'An error occurred during upload';\n    emit('upload-error', err instanceof Error ? err : new Error('Upload failed'));\n  } finally {\n    uploading.value = false;\n  }\n}\n\nfunction triggerFileInput() {\n  if (fileInput.value) {\n    fileInput.value.click();\n  }\n}\n\nfunction clearSelection() {\n  selectedFiles.value = [];\n  if (fileInput.value) fileInput.value.value = '';\n  error.value = null;\n}\n</script>\n\n<template>\n  <div class=\"file-uploader\">\n    <input\n      ref=\"fileInput\"\n      type=\"file\"\n      :accept=\"acceptedFileTypes\"\n      :multiple=\"multiple\"\n      class=\"hidden\"\n      @change=\"handleFileSelect\"\n    />\n    \n    <div class=\"mb-4\">\n      <button\n        type=\"button\"\n        @click=\"triggerFileInput\"\n        class=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\n        :disabled=\"uploading\"\n      >\n        Select File{{ multiple ? 's' : '' }}\n      </button>\n      \n      <span v-if=\"maxSize\" class=\"ml-2 text-sm text-gray-500\">\n        Max size: {{ maxSize }}MB\n      </span>\n    </div>\n    \n    <div v-if=\"selectedFiles.length > 0\" class=\"mb-4\">\n      <div class=\"text-sm font-medium mb-2\">Selected Files:</div>\n      <ul class=\"space-y-1\">\n        <li v-for=\"(file, index) in selectedFiles\" :key=\"index\" class=\"flex items-center\">\n          <span class=\"truncate max-w-md\">{{ file.name }}</span>\n          <span class=\"ml-2 text-xs text-gray-500\">\n            ({{ (file.size / 1024).toFixed(1) }} KB)\n          </span>\n        </li>\n      </ul>\n      \n      <div class=\"mt-3 flex space-x-2\">\n        <button\n          type=\"button\"\n          @click=\"uploadFiles\"\n          class=\"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2\"\n          :disabled=\"uploading\"\n        >\n          Upload\n        </button>\n        \n        <button\n          type=\"button\"\n          @click=\"clearSelection\"\n          class=\"px-3 py-1 bg-gray-200 text-gray-800 text-sm rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2\"\n          :disabled=\"uploading\"\n        >\n          Clear\n        </button>\n      </div>\n    </div>\n    \n    <div v-if=\"uploading\" class=\"mb-4\">\n      <div class=\"w-full bg-gray-200 rounded-full h-2.5\">\n        <div\n          class=\"bg-blue-600 h-2.5 rounded-full\"\n          :style=\"{ width: `${uploadProgress}%` }\"\n        ></div>\n      </div>\n      <div class=\"text-sm text-center mt-1\">\n        {{ uploadProgress }}% Uploaded\n      </div>\n    </div>\n    \n    <div v-if=\"error\" class=\"text-red-600 text-sm mt-2\">\n      {{ error }}\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.hidden {\n  display: none;\n}\n</style> ","<script setup lang=\"ts\">\nimport { ref } from 'vue';\nimport FileUploader from '../components/FileUploader.vue';\n\nconst uploadedFiles = ref<Array<{ url: string; key: string }>>([]);\n\nfunction handleUploadSuccess(files: Array<{ url: string; key: string }>) {\n  uploadedFiles.value = [...uploadedFiles.value, ...files];\n}\n\nfunction handleUploadError(error: Error) {\n  console.error('Upload error:', error);\n}\n</script>\n\n<template>\n  <div class=\"container mx-auto px-4 py-8\">\n    <h1 class=\"text-2xl font-bold mb-6\">File Upload Demo</h1>\n    \n    <div class=\"bg-white shadow-md rounded-lg p-6 mb-8\">\n      <h2 class=\"text-xl font-semibold mb-4\">Upload Files</h2>\n      \n      <FileUploader\n        folder=\"demo\"\n        accept=\"image/*,.pdf\"\n        :multiple=\"true\"\n        :max-size=\"5\"\n        @upload-success=\"handleUploadSuccess\"\n        @upload-error=\"handleUploadError\"\n      />\n    </div>\n    \n    <div v-if=\"uploadedFiles.length > 0\" class=\"bg-white shadow-md rounded-lg p-6\">\n      <h2 class=\"text-xl font-semibold mb-4\">Uploaded Files</h2>\n      \n      <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n        <div\n          v-for=\"(file, index) in uploadedFiles\"\n          :key=\"index\"\n          class=\"border rounded-lg overflow-hidden\"\n        >\n          <div v-if=\"file.url.endsWith('.jpg') || file.url.endsWith('.jpeg') || file.url.endsWith('.png') || file.url.endsWith('.gif') || file.url.endsWith('.webp')\">\n            <img :src=\"file.url\" alt=\"Uploaded file\" class=\"w-full h-48 object-cover\" />\n          </div>\n          <div v-else-if=\"file.url.endsWith('.pdf')\" class=\"bg-gray-100 h-48 flex items-center justify-center\">\n            <div class=\"text-center\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-12 w-12 mx-auto text-red-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z\" />\n              </svg>\n              <span class=\"block mt-2\">PDF Document</span>\n            </div>\n          </div>\n          <div v-else class=\"bg-gray-100 h-48 flex items-center justify-center\">\n            <div class=\"text-center\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-12 w-12 mx-auto text-gray-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n              </svg>\n              <span class=\"block mt-2\">File</span>\n            </div>\n          </div>\n          \n          <div class=\"p-3 border-t\">\n            <div class=\"truncate text-sm font-medium\">{{ file.key.split('/').pop() }}</div>\n            <div class=\"flex justify-between items-center mt-2\">\n              <a\n                :href=\"file.url\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                class=\"text-blue-600 hover:text-blue-800 text-sm\"\n              >\n                View File\n              </a>\n              <span class=\"text-xs text-gray-500\">{{ new Date().toLocaleDateString() }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template> "],"names":["props","__props","emit","__emit","fileInput","ref","selectedFiles","uploading","uploadProgress","error","maxSizeBytes","computed","acceptedFileTypes","handleFileSelect","event","input","file","uploadFiles","uploadedFiles","formData","response","axios","progressEvent","err","triggerFileInput","clearSelection","handleUploadSuccess","files","handleUploadError"],"mappings":"k2BAIA,MAAMA,EAAQC,EAORC,EAAOC,EAKPC,EAAYC,EAA6B,IAAI,EAC7CC,EAAgBD,EAAY,EAAE,EAC9BE,EAAYF,EAAI,EAAK,EACrBG,EAAiBH,EAAI,CAAC,EACtBI,EAAQJ,EAAmB,IAAI,EAE/BK,EAAeC,EAAS,KAAOX,EAAM,SAAW,IAAM,KAAO,IAAI,EACjEY,EAAoBD,EAAS,IAAMX,EAAM,QAAU,GAAG,EAE5D,SAASa,EAAiBC,EAAc,CACtC,MAAMC,EAAQD,EAAM,OAChB,GAACC,EAAM,MAEX,CAAAN,EAAM,MAAQ,KACdH,EAAc,MAAQ,MAAM,KAAKS,EAAM,KAAK,EAGjC,UAAAC,KAAQV,EAAc,MAC3B,GAAAU,EAAK,KAAON,EAAa,MAAO,CAClCD,EAAM,MAAQ,QAAQO,EAAK,IAAI,gCAAgChB,EAAM,SAAW,EAAE,KAClFM,EAAc,MAAQ,CAAC,EACnBF,EAAU,QAAiBA,EAAA,MAAM,MAAQ,IAC7C,MAAA,EAEJ,CAGF,eAAea,GAAc,CACvB,GAAAX,EAAc,MAAM,SAAW,EAEnC,CAAAC,EAAU,MAAQ,GAClBC,EAAe,MAAQ,EACvBC,EAAM,MAAQ,KAEV,GAAA,CACF,MAAMS,EAAgB,CAAC,EAEZ,UAAAF,KAAQV,EAAc,MAAO,CAChC,MAAAa,EAAW,IAAI,SACZA,EAAA,OAAO,OAAQH,CAAI,EACxBhB,EAAM,QACCmB,EAAA,OAAO,SAAUnB,EAAM,MAAM,EAGxC,MAAMoB,EAAW,MAAMC,EAAM,KAAK,qBAAsBF,EAAU,CAChE,QAAS,CACP,eAAgB,qBAClB,EACA,iBAAmBG,GAAkB,CAC/BA,EAAc,QAChBd,EAAe,MAAQ,KAAK,MAAOc,EAAc,OAAS,IAAOA,EAAc,KAAK,EACtF,CACF,CACD,EAEDJ,EAAc,KAAK,CACjB,IAAKE,EAAS,KAAK,IACnB,IAAKA,EAAS,KAAK,GAAA,CACpB,CAAA,CAGHlB,EAAK,iBAAkBgB,CAAa,EACpCZ,EAAc,MAAQ,CAAC,EACnBF,EAAU,QAAiBA,EAAA,MAAM,MAAQ,UACtCmB,EAAK,CACJ,QAAA,MAAM,yBAA0BA,CAAG,EAC3Cd,EAAM,MAAQc,aAAe,MAAQA,EAAI,QAAU,kCACnDrB,EAAK,eAAgBqB,aAAe,MAAQA,EAAM,IAAI,MAAM,eAAe,CAAC,CAAA,QAC5E,CACAhB,EAAU,MAAQ,EAAA,EACpB,CAGF,SAASiB,GAAmB,CACtBpB,EAAU,OACZA,EAAU,MAAM,MAAM,CACxB,CAGF,SAASqB,GAAiB,CACxBnB,EAAc,MAAQ,CAAC,EACnBF,EAAU,QAAiBA,EAAA,MAAM,MAAQ,IAC7CK,EAAM,MAAQ,IAAA,whEC9FV,MAAAS,EAAgBb,EAAyC,EAAE,EAEjE,SAASqB,EAAoBC,EAA4C,CACvET,EAAc,MAAQ,CAAC,GAAGA,EAAc,MAAO,GAAGS,CAAK,CAAA,CAGzD,SAASC,EAAkBnB,EAAc,CAC/B,QAAA,MAAM,gBAAiBA,CAAK,CAAA"}