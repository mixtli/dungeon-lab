import{b as K,u as O}from"./index-cqCp6bjN.js";import{p as Q,s as X,f as Y,g as Z,e as m,h as ee}from"./ui-vendor-DW-xeH-g.js";import{x as $,c as le,r as w,h as te,y as E,A as c,I as ae,P as l,G as x,J as T,H as a,L as v,u as y,ag as d,aq as oe,M as ne,z as g}from"./vue-vendor-CXTDXhET.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"plugin-manager"},ie={class:"flex justify-between items-center mb-6"},se={class:"flex justify-between items-center"},de={class:"flex space-x-2"},re={key:1,class:"text-center py-6 text-gray-500"},me={class:"dialog-footer"},pe={class:"dialog-footer"},fe=$({__name:"PluginManager",setup(B){const p=K(),U=O(),A=le(()=>{var o;return((o=U.user)==null?void 0:o.isAdmin)||!1}),i=w(!1),P=w(!1),_=w(!1),n=w({name:"",version:"1.0.0",description:"",author:"",website:"",type:"gameSystem",entryPoint:"",enabled:!0}),u=w({id:"",name:"",version:"",description:"",author:"",website:"",enabled:!0});async function b(){i.value=!0;try{await p.fetchPlugins()}catch(o){m.error("Failed to load plugins"),console.error("Error loading plugins:",o)}finally{i.value=!1}}function S(){n.value={name:"",version:"1.0.0",description:"",author:"",website:"",type:"gameSystem",entryPoint:"",enabled:!0},P.value=!1}function h(o){u.value={id:o.id,name:o.name,version:o.version,description:o.description||"",author:o.author||"",website:o.website||"",enabled:o.enabled},_.value=!0}async function z(){try{i.value=!0,await p.registerPlugin(n.value),m.success("Plugin added successfully"),S(),await b()}catch(o){m.error("Failed to add plugin"),console.error("Error adding plugin:",o)}finally{i.value=!1}}async function I(){try{i.value=!0,await p.updatePlugin(u.value.id,u.value),m.success("Plugin updated successfully"),_.value=!1,await b()}catch(o){m.error("Failed to update plugin"),console.error("Error updating plugin:",o)}finally{i.value=!1}}async function j(o){try{i.value=!0,o.enabled?(await p.disablePlugin(o.id),m.success("Plugin disabled")):(await p.enablePlugin(o.id),m.success("Plugin enabled")),await b()}catch(e){m.error("Failed to toggle plugin status"),console.error("Error toggling plugin status:",e)}finally{i.value=!1}}async function G(o){try{await ee.confirm(`Are you sure you want to delete the plugin "${o.name}"? This action cannot be undone.`,"Delete Plugin",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}),i.value=!0,await p.unregisterPlugin(o.id),m.success("Plugin deleted successfully"),await b()}catch(e){e!=="cancel"&&(m.error("Failed to delete plugin"),console.error("Error deleting plugin:",e))}finally{i.value=!1}}return te(async()=>{await b()}),(o,e)=>{const f=d("el-button"),V=d("el-table-column"),W=d("el-tag"),C=d("el-tooltip"),H=d("el-table"),J=d("el-card"),r=d("el-input"),s=d("el-form-item"),k=d("el-option"),L=d("el-select"),D=d("el-switch"),N=d("el-form"),F=d("el-dialog"),R=oe("loading");return g(),E("div",ue,[c("div",ie,[e[19]||(e[19]=c("h1",{class:"text-2xl font-semibold"},"Plugin Management",-1)),A.value?(g(),x(f,{key:0,type:"primary",onClick:e[0]||(e[0]=t=>P.value=!0),icon:y(Q)},{default:a(()=>e[18]||(e[18]=[v(" Add Plugin ")])),_:1},8,["icon"])):T("",!0)]),ae((g(),x(J,{class:"mb-6"},{header:a(()=>[c("div",se,[e[21]||(e[21]=c("span",null,"Available Plugins",-1)),l(f,{size:"small",onClick:b,loading:i.value},{default:a(()=>e[20]||(e[20]=[v(" Refresh ")])),_:1},8,["loading"])])]),default:a(()=>[y(p).plugins.length>0?(g(),x(H,{key:0,data:y(p).plugins,style:{width:"100%"}},{default:a(()=>[l(V,{prop:"name",label:"Name"}),l(V,{prop:"version",label:"Version",width:"100"}),l(V,{prop:"type",label:"Type",width:"120"}),l(V,{label:"Status",width:"120"},{default:a(({row:t})=>[l(W,{type:t.enabled?"success":"danger"},{default:a(()=>[v(ne(t.enabled?"Enabled":"Disabled"),1)]),_:2},1032,["type"])]),_:1}),A.value?(g(),x(V,{key:0,label:"Actions",width:"200"},{default:a(({row:t})=>[c("div",de,[l(C,{content:"Toggle status"},{default:a(()=>[l(f,{size:"small",circle:"",type:t.enabled?"warning":"success",onClick:M=>j(t),icon:y(X)},null,8,["type","onClick","icon"])]),_:2},1024),l(C,{content:"Edit"},{default:a(()=>[l(f,{size:"small",circle:"",type:"primary",onClick:M=>h(t),icon:y(Y)},null,8,["onClick","icon"])]),_:2},1024),l(C,{content:"Delete"},{default:a(()=>[l(f,{size:"small",circle:"",type:"danger",onClick:M=>G(t),icon:y(Z)},null,8,["onClick","icon"])]),_:2},1024)])]),_:1})):T("",!0)]),_:1},8,["data"])):(g(),E("div",re,' No plugins available. Click "Add Plugin" to add your first plugin. '))]),_:1})),[[R,i.value]]),l(F,{modelValue:P.value,"onUpdate:modelValue":e[9]||(e[9]=t=>P.value=t),title:"Add New Plugin",width:"500px"},{footer:a(()=>[c("span",me,[l(f,{onClick:S},{default:a(()=>e[22]||(e[22]=[v("Cancel")])),_:1}),l(f,{type:"primary",onClick:z,loading:i.value},{default:a(()=>e[23]||(e[23]=[v(" Add Plugin ")])),_:1},8,["loading"])])]),default:a(()=>[l(N,{model:n.value,"label-position":"top"},{default:a(()=>[l(s,{label:"Name",required:""},{default:a(()=>[l(r,{modelValue:n.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.name=t)},null,8,["modelValue"])]),_:1}),l(s,{label:"Version",required:""},{default:a(()=>[l(r,{modelValue:n.value.version,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.version=t)},null,8,["modelValue"])]),_:1}),l(s,{label:"Type",required:""},{default:a(()=>[l(L,{modelValue:n.value.type,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.type=t),style:{width:"100%"}},{default:a(()=>[l(k,{label:"Game System",value:"gameSystem"}),l(k,{label:"Extension",value:"extension"}),l(k,{label:"Theme",value:"theme"})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"Entry Point",required:""},{default:a(()=>[l(r,{modelValue:n.value.entryPoint,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.entryPoint=t),placeholder:"Path to plugin entry file"},null,8,["modelValue"])]),_:1}),l(s,{label:"Description"},{default:a(()=>[l(r,{modelValue:n.value.description,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.description=t),type:"textarea",rows:"3"},null,8,["modelValue"])]),_:1}),l(s,{label:"Author"},{default:a(()=>[l(r,{modelValue:n.value.author,"onUpdate:modelValue":e[6]||(e[6]=t=>n.value.author=t)},null,8,["modelValue"])]),_:1}),l(s,{label:"Website"},{default:a(()=>[l(r,{modelValue:n.value.website,"onUpdate:modelValue":e[7]||(e[7]=t=>n.value.website=t)},null,8,["modelValue"])]),_:1}),l(s,{label:"Status"},{default:a(()=>[l(D,{modelValue:n.value.enabled,"onUpdate:modelValue":e[8]||(e[8]=t=>n.value.enabled=t),"active-text":"Enabled","inactive-text":"Disabled"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(F,{modelValue:_.value,"onUpdate:modelValue":e[17]||(e[17]=t=>_.value=t),title:"Edit Plugin",width:"500px"},{footer:a(()=>[c("span",pe,[l(f,{onClick:e[16]||(e[16]=t=>_.value=!1)},{default:a(()=>e[24]||(e[24]=[v("Cancel")])),_:1}),l(f,{type:"primary",onClick:I,loading:i.value},{default:a(()=>e[25]||(e[25]=[v(" Save Changes ")])),_:1},8,["loading"])])]),default:a(()=>[l(N,{model:u.value,"label-position":"top"},{default:a(()=>[l(s,{label:"Name",required:""},{default:a(()=>[l(r,{modelValue:u.value.name,"onUpdate:modelValue":e[10]||(e[10]=t=>u.value.name=t)},null,8,["modelValue"])]),_:1}),l(s,{label:"Version",required:""},{default:a(()=>[l(r,{modelValue:u.value.version,"onUpdate:modelValue":e[11]||(e[11]=t=>u.value.version=t)},null,8,["modelValue"])]),_:1}),l(s,{label:"Description"},{default:a(()=>[l(r,{modelValue:u.value.description,"onUpdate:modelValue":e[12]||(e[12]=t=>u.value.description=t),type:"textarea",rows:"3"},null,8,["modelValue"])]),_:1}),l(s,{label:"Author"},{default:a(()=>[l(r,{modelValue:u.value.author,"onUpdate:modelValue":e[13]||(e[13]=t=>u.value.author=t)},null,8,["modelValue"])]),_:1}),l(s,{label:"Website"},{default:a(()=>[l(r,{modelValue:u.value.website,"onUpdate:modelValue":e[14]||(e[14]=t=>u.value.website=t)},null,8,["modelValue"])]),_:1}),l(s,{label:"Status"},{default:a(()=>[l(D,{modelValue:u.value.enabled,"onUpdate:modelValue":e[15]||(e[15]=t=>u.value.enabled=t),"active-text":"Enabled","inactive-text":"Disabled"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),ce=q(fe,[["__scopeId","data-v-866d8857"]]),ve={class:"plugin-manager-view"},ge=$({__name:"PluginManagerView",setup(B){return(p,U)=>(g(),E("div",ve,[l(ce)]))}}),we=q(ge,[["__scopeId","data-v-d852276f"]]);export{we as default};
//# sourceMappingURL=PluginManagerView-C1TIdaOP.js.map
